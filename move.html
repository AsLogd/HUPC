<!doctype html>
<html>
  <head>
    <title>Move</title>
   
    <script src="/socket.io/socket.io.js"></script>
    <script src="js/third-party/threejs/three.js"></script>
  </head>
  <body>
    <script>
      var socket = io();
      document.addEventListener('touchstart', handleTouchEvent, true);
      document.addEventListener('touchmove', handleTouchEvent, true);
      document.addEventListener('touchend', handleTouchEventEnd, true);

      var screenWidth = window.innerWidth;
      var screenHeight = window.innerHeight;

      function map(in_min, in_max, out_min, out_max, point) {
        return (point - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
      }

       function handleTouchEventEnd(e) {
        var moveVector = {x:0, y:0};
        socket.emit('move', moveVector);
       }

      function handleTouchEvent(e) {
        if (e.touches.length === 0 ) return;
        e.preventDefault();
        e.stopPropagation();
        var touch = e.touches[0];
       // alert("X:" + touch.pageX + ", Y:" + touch.pageY);
        var moveVector = {x:0, y:0};
        moveVector.x = map(0, screenWidth, -1,1, touch.pageX);
        moveVector.y = -map(0, screenHeight, 1,-1, touch.pageY);
        //alert( "X:" + moveVector.x+ ", Y:" + moveVector.y);
        socket.emit('move', moveVector);
        //moveVector.x = 

       // touch.pageX
        //touch.pageY
      }

    </script>
  </body>
</html>